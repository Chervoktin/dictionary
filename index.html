<html>
<title>
    Словарь
</title>
<script>
    let sentences = [];
    let currentElement = 1;
    const baseUrl = "http://localhost:3000/";
    async function get() {
        let url = baseUrl + "training/" + document.getElementById("countOfSentences").value;
        document.getElementById("sentence").disabled = false;
      
        fetch(url).then(response =>
            response.json()
        ).then(response => {
            sentences = response;
            currentElement = 1;
            document.getElementById("currentElement").innerHTML = currentElement + "/" + sentences.length;
            document.getElementById("audio").src = baseUrl + "example/" + sentences[currentElement-1].fileName;
        }).
            catch(error => {
                document.getElementById("error").innerHTML = error;
            })
    }

    function typeText(element) {
        let sentence = sentences[currentElement - 1];
        if (element.value === sentence.sentence) {
            currentElement += 1;
            document.getElementById("currentElement").innerHTML = currentElement + "/" + sentences.length;
            let url = baseUrl + "progress/" + sentence.id;
            element.value = "";
            fetch(url, { method: "POST" }).catch(error => alert(error));
        }
        if(currentElement > sentences.length){
            document.getElementById("currentElement").innerHTML = "фразы закончились";
            element.disabled=true;
        }
    }
</script>

<body>
    <div id="error"></div>
    Количество слов для тренировки:
    <input id="countOfSentences" type="number"></input>
    <input type="submit" value="получить" onclick=get();></input>
    <br>
    <input id="sentence" disabled="disabled" type="text" oninput=typeText(this);></input>
    <audio id="audio" controls></audio>
    <div id="currentElement"></div>

</body>

</html>